# 前端调试指南

## 🔧 已修复的问题

### 问题1：数据流卡片显示不完整
**修复内容：**
- 添加了API响应字段兼容性处理
- 增强了错误处理和调试日志
- 修复了状态重置逻辑

**修复位置：**
- `frontend/src/stores/transformation.ts` - 第120-160行
- 添加了对不同API响应格式的兼容性支持

### 问题2：图表类型选择器功能失效
**修复内容：**
- 修复了图表类型切换时的状态重置
- 添加了详细的调试日志
- 改进了错误处理机制

**修复位置：**
- `frontend/src/views/Transformation/index.vue` - 第394-419行
- `frontend/src/stores/transformation.ts` - 第70-87行

## 🧪 调试工具

### 新增调试功能
1. **调试状态按钮** - 点击"🔍 调试状态"查看当前所有状态
2. **详细日志** - 控制台输出详细的执行过程
3. **全面测试** - 点击"🧪 全面测试"执行完整测试流程

### 调试步骤
1. 打开浏览器开发者工具（F12）
2. 访问 http://localhost:3000/transformation
3. 点击"🔍 调试状态"查看初始状态
4. 选择不同图表类型，观察控制台日志
5. 点击"执行转换"，观察数据流变化
6. 点击"🧪 全面测试"执行完整测试

## 📊 预期行为

### 正常工作流程
1. **选择图表类型** → 控制台显示"🔄 图表类型切换"
2. **状态重置** → 所有卡片清空，显示"暂无数据"
3. **获取模板** → 卡片1显示JSON模板
4. **第一阶段转换** → 卡片2显示ECharts结构
5. **第二阶段转换** → 卡片3显示最终配置
6. **图表渲染** → 卡片4显示图表

### 调试检查点
- 每个步骤都应该有对应的控制台日志
- API调用应该返回正确的数据结构
- 状态切换应该正确更新UI显示

## 🚨 常见问题排查

### 如果卡片3、4仍然没有数据
1. 检查控制台是否有API错误
2. 确认后端服务是否正常运行在8080端口
3. 检查网络请求是否成功返回数据
4. 使用"🔍 调试状态"查看store中的数据

### 如果图表类型切换无效
1. 检查控制台是否有"🔄 图表类型切换"日志
2. 确认API请求是否携带正确的chartId
3. 检查后端是否返回不同的模板数据

## 🔗 相关文件
- `frontend/src/views/Transformation/index.vue` - 主界面组件
- `frontend/src/stores/transformation.ts` - 状态管理
- `frontend/src/api/index.ts` - API调用
